---
title: "4.3 实例演示"
summary: ""
date: 2025-09-22T08:44:00+08:00
---

我们用一个完整的例子，来演示使用加一平滑（add-one smoothing）的朴素贝叶斯分类器的训练和测试过程。我们使用情感分析任务，包含两个类别：正面（+）和负面（−），并从真实的电影评论中简化出以下微型训练集和测试文档。

| | 类别 | 文档 |
| --- | --- | --- |
| **训练集** | − | just plain boring |
| | − | entirely predictable and lacks energy |
| | − | no surprises and very few laughs |
| | + | very powerful |
| | + | the most fun film of the summer |
| **测试集** | ? | predictable with no fun |

根据公式 (4.11) $P(c) = \frac{N_c}{N_{doc}}$，我们计算两个类别的先验概率：

$$
P(−) = \frac{3}{5}, \quad P(+) = \frac{2}{5}
$$

单词 *with* 未在训练集中出现，因此我们将其完全忽略（如前所述，朴素贝叶斯通常不为未知词建模）。其余三个单词 “predictable”、“no” 和 “fun” 在训练集中的似然概率如下，根据公式 (4.14) 计算得出（训练集中其余单词的概率计算留作读者练习）：

$$
P(\text{“predictable”}|−) = \frac{1 + 1}{14 + 20}
$$

$$
P(\text{“predictable”}|+) = \frac{0 + 1}{9 + 20}
$$

$$
P(\text{“no”}|−) = \frac{1 + 1}{14 + 20}
$$

$$
P(\text{“no”}|+) = \frac{0 + 1}{9 + 20}
$$

$$
P(\text{“fun”}|−) = \frac{0 + 1}{14 + 20}
$$

$$
P(\text{“fun”}|+) = \frac{1 + 1}{9 + 20}
$$

对于测试句子 $S =$ “predictable with no fun”，在移除词 “with” 后，根据公式 (4.9)，我们计算其所属类别如下：

$$
P(−)P(S|−) = \frac{3}{5} × \frac{2 ×2 ×1}{34^3} = 6.1 ×10^{−5}
$$

$$
P(+)P(S|+) = \frac{2}{5} × \frac{1 ×1 ×2}{29^3} = 3.2 ×10^{−5}
$$

因此该模型将测试句子预测为**负面**类别。


<nav class="pagination justify-content-between">
<a href="../ch4-02">4.2 训练朴素贝叶斯分类器</a>
<a href="../">目录</a>
<a href="../ch5">第5章 逻辑回归</a>
</nav>

