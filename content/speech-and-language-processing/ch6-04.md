---
title: "6.4 用余弦度量相似性"
summary: ""
date: 2025-10-13T10:27:00+08:00
---

为了度量两个目标词 $v$ 和 $w$ 之间的相似性，我们需要一种度量方法，它能接受两个向量（维度相同，要么都以词语为维度，因此长度为 $|V|$，要么都以文档为维度，长度为 $|D|$），并给出它们相似程度的度量值。迄今为止最常用的相似性度量是向量之间夹角的**余弦**（cosine）。

余弦——像NLP中使用的大多数向量相似性度量一样——基于线性代数中的**点积**（dot product）运算符，也称为内积：

$$
\begin{aligned}
\text{点积}(\mathbf{v},\mathbf{w}) &= \mathbf{v} \cdot \mathbf{w} \\
&= \sum_{i=1}^N v_i w_i \\
&= v_1w_1 + v_2w_2 + ... + v_N w_N
\end{aligned}
\tag{6.7}
$$

点积可以作为一种相似性度量，因为当两个向量在相同维度上具有较大的值时，点积的值往往会很高。相反，如果两个向量在不同维度上为零（即正交向量），它们的点积为0，这表示它们的差异性很强。

然而，这种原始的点积作为相似性度量存在一个问题：它偏向于长度更长的向量。向量的长度定义为：

$$
|\mathbf{v}| = \sqrt{\sum_{i=1}^N v_i^2}
$$

(6.8)

如果一个向量更长，每个维度的值更高，其点积也会更高。更频繁出现的词具有更长的向量，因为它们倾向于与更多的词共现，并且与每个共现词的共现值也更高。因此，原始点积对高频词的值会更高。但这是一个问题；我们希望相似性度量能告诉我们两个词有多相似，而不受它们频率的影响。

我们通过将点积除以两个向量的长度来对点积进行归一化，从而修正这一问题。这种**归一化的点积**实际上等于两个向量之间夹角的余弦，这源于两个向量 **a** 和 **b** 之间点积的定义：

$$
\begin{aligned}
\mathbf{a} \cdot \mathbf{b} = |\mathbf{a}||\mathbf{b}| \cos\theta \\
\frac{\mathbf{a} \cdot \mathbf{b}}{|\mathbf{a}||\mathbf{b}|} = \cos\theta
\end{aligned}
\tag{6.9}
$$

因此，两个向量 **v** 和 **w** 之间的**余弦**相似性度量可计算为：

$$
\begin{aligned}
\text{余弦}(v,w) = \frac{v \cdot w}{|v||w|} \\
= \frac{\sum_{i=1}^N v_iw_i}{\sqrt{\sum_{i=1}^N v_i^2}\sqrt{\sum_{i=1}^N w_i^2}}
\end{aligned}
\tag{6.10}
$$

对于某些应用，我们会预先通过将每个向量除以其长度来对其进行归一化，从而创建长度为1的**单位向量**。因此，可以将向量 **a** 除以 |**a**| 来计算出一个单位向量。对于单位向量，点积就等于余弦值。

余弦值的范围从1（向量方向相同）到0（向量正交），再到-1（向量方向相反）。但由于原始的频率值是非负的，这些向量的余弦值范围为0到1。

我们看看余弦如何计算“cherry”（樱桃）和“digital”（数字）哪个词在意义上更接近“information”（信息），仅使用下表简化后的原始计数数据：

| | pie（派） | data（数据） | computer（计算机） |
| :--- | :--- | :--- | :--- |
| **cherry**（樱桃） | 442 | 8 | 2 |
| **digital**（数字） | 5 | 1683 | 1670 |
| **information**（信息） | 5 | 3982 | 3325 |

$$
\text{余弦}(cherry, information) = \frac{442*5 + 8*3982 + 2*3325}{\sqrt{442^2 + 8^2 + 2^2} * \sqrt{5^2 + 3982^2 + 3325^2}} = 0.018
$$

$$
\text{余弦}(digital, information) = \frac{5*5 + 1683*3982 + 1670*3325}{\sqrt{5^2 + 1683^2 + 1670^2} * \sqrt{5^2 + 3982^2 + 3325^2}} = 0.996
$$

该模型判断出“information”与“digital”的语义接近程度远高于与“cherry”，这一结果看起来是合理的。图6.8展示了一个可视化示意图。

![](/images/speech-and-language-processing/slp-fig-6-8.png)

**图6.8** 余弦相似性的一个（粗略）图示，展示了在由“computer”（计算机）和“pie”（派）附近词频定义的二维空间中，三个词（cherry、digital、information）的向量。该图并未直接显示余弦值，而是突出了角度；注意“digital”和“information”之间的夹角小于“cherry”和“information”之间的夹角。当两个向量更相似时，余弦值更大，但夹角更小；当两个向量夹角最小时（0°），余弦值达到最大值（1）；其他所有角度的余弦值都小于1。


<nav class="pagination justify-content-between">
<a href="../ch6-03">6.3 词语与向量</a>
<a href="../">目录</a>
<span></span>
</nav>

